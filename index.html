<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Resilient Voice Store</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <h1>Resilient T-Voice Store</h1>
        <p>Custom Apparel with Purpose</p>
        <nav>
            <div class="hamburger" onclick="toggleMenu()">&#9776;</div>
            <ul id="nav-menu">
                <li><a href="#" onclick="filterProducts('all')">Home</a></li>
                <li><a href="#" onclick="filterProducts('resilience')">Resilience Collection</a></li>
                <li><a href="#" onclick="filterProducts('grace')">Grace Collection</a></li>
                <li><a href="#" onclick="filterProducts('warrior')">Warrior Spirit Co.</a></li>
            </ul>
        </nav>
    </header>

    <div class="container">
        <div class="main-content">
            <aside class="collections-sidebar">
                <h2>Our Collections</h2>
                <div class="collection-card resilience">
                    <h3>The Resilience Collection</h3>
                    <p>The heartbeat of our brand. Forged from the powerful words of Scripture, 
                        these designs—like Strength, Steadfast, and Fortitude—are affirmations 
                        of your identity and calling. When you choose an item from this collection, 
                        you are choosing to anchor your faith and face adversity with quiet power. 
                        Plus, every purchase fuels our mission to support Central MN nonprofits.</p>
                </div>
                <div class="collection-card grace">
                    <h3>The Grace Collection</h3>
                    <p>Rooted in Scripture's promise of unmerited favor, this collection is designed 
                        for the soul seeking true rest and profound joy. From the affirmation of Joy 
                        to the comfort of Peace, each piece reflects the generous, unending love gifted 
                        to us. This apparel is a soft place to land. Your purchase helps us share that 
                        grace by funding community initiatives in Minnesota.</p>
                </div>
                <div class="collection-card warrior">
                    <h3>Warrior Spirit Co. Unbroken Series</h3>
                    <p>Built for the grind and defined by the mindset. This collection delivers 
                        performance-grade gear engineered to withstand your toughest sessions, giving you 
                        the confidence and cushion to push past plateaus. Every piece is a uniform for the 
                        dedicated athlete, blending superior function with the unyielding focus of a true 
                        competitor. This is the gear that works as hard as you do.</p>
                </div>
            </aside>
            <section class="products-section">
                <h2>Shop Our Products</h2>
                <div class="product-grid" id="product-grid">
                    <!-- Product cards populated by JavaScript -->
                </div>
            </section>
        </div>
    </div>

    <footer>
        <p>Every purchase supports Central MN nonprofits through The Resilient Voice mission.</p>
        <p>&copy; 2025 Resilient Voice. All rights reserved.</p>
    </footer>

    <script src="https://js.stripe.com/v3/"></script>
    <script>
        // Initialize Stripe
        const stripe = Stripe('pk_test_YOUR_STRIPE_PUBLISHABLE_KEY'); // Replace with your key

        // Sample products with new categories
        const products = [
            {
                id: 1,
                name: 'Strength Tee',
                price: 29.99,
                image: 'https://via.placeholder.com/300x300?text=Strength+Tee', // Replace with Printful image
                printfulVariantId: 'YOUR_VARIANT_ID_1',
                sizes: ['S', 'M', 'L', 'XL'],
                colors: ['Black', 'White'],
                category: 'resilience'
            },
            {
                id: 2,
                name: 'Joy Hoodie',
                price: 49.99,
                image: 'https://via.placeholder.com/300x300?text=Joy+Hoodie',
                printfulVariantId: 'YOUR_VARIANT_ID_2',
                sizes: ['S', 'M', 'L'],
                colors: ['Gray', 'Blue'],
                category: 'grace'
            },
            {
                id: 3,
                name: 'Unbroken Performance Shirt',
                price: 39.99,
                image: 'https://via.placeholder.com/300x300?text=Performance+Shirt',
                printfulVariantId: 'YOUR_VARIANT_ID_3',
                sizes: ['S', 'M', 'L', 'XL'],
                colors: ['Black', 'Red'],
                category: 'warrior'
            },
            {
                id: 4,
                name: 'Fortitude Cap',
                price: 24.99,
                image: 'https://via.placeholder.com/300x300?text=Fortitude+Cap',
                printfulVariantId: 'YOUR_VARIANT_ID_4',
                sizes: ['One Size'],
                colors: ['Navy', 'White'],
                category: 'resilience'
            }
        ];

        // Populate product grid
        function displayProducts(category = 'all') {
            const productGrid = document.getElementById('product-grid');
            productGrid.innerHTML = '';
            const filteredProducts = category === 'all' ? products : products.filter(p => p.category === category);
            filteredProducts.forEach(product => {
                const card = document.createElement('div');
                card.className = 'product-card';
                card.innerHTML = `
                    <img src="${product.image}" alt="${product.name}">
                    <h3>${product.name}</h3>
                    <p>$${product.price.toFixed(2)}</p>
                    <select id="size-${product.id}" aria-label="Select size">
                        ${product.sizes.map(size => `<option value="${size}">${size}</option>`).join('')}
                    </select>
                    <select id="color-${product.id}" aria-label="Select color">
                        ${product.colors.map(color => `<option value="${color}">${color}</option>`).join('')}
                    </select>
                    <button onclick="buyNow(${product.id})">Buy Now</button>
                `;
                productGrid.appendChild(card);
            });
        }

        // Filter products by category
        function filterProducts(category) {
            displayProducts(category);
        }

        // Toggle mobile menu
        function toggleMenu() {
            const navMenu = document.getElementById('nav-menu');
            navMenu.classList.toggle('active');
        }

        // Initial display
        displayProducts();

        // Handle Buy Now button
        async function buyNow(productId) {
            const product = products.find(p => p.id === productId);
            const size = document.getElementById(`size-${productId}`).value;
            const color = document.getElementById(`color-${productId}`).value;

            // Create Stripe Checkout session (requires backend)
            try {
                const response = await fetch('https://your-backend.com/create-checkout-session', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        productId: product.id,
                        name: product.name,
                        price: product.price,
                        variantId: product.printfulVariantId,
                        size,
                        color
                    })
                });
                const session = await response.json();
                await stripe.redirectToCheckout({ sessionId: session.id });
            } catch (error) {
                console.error('Checkout error:', error);
                alert('Error processing payment. Please try again.');
            }

            // Sync order to Printful
            try {
                await fetch('https://api.printful.com/orders', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer YOUR_PRINTFUL_API_KEY',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        recipient: {
                            name: 'Customer Name', // Collect from checkout
                            address1: '123 Main St',
                            city: 'City',
                            state_code: 'CA',
                            country_code: 'US',
                            zip: '12345'
                        },
                        items: [{
                            variant_id: product.printfulVariantId,
                            quantity: 1,
                            name: `${product.name} (${size}, ${color})`
                        }]
                    })
                });
                console.log('Order sent to Printful');
            } catch (error) {
                console.error('Printful error:', error);
                alert('Error syncing order. Contact support.');
            }
        }
    </script>
</body>
</html>
